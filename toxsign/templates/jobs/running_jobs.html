{% extends "base.html" %}
{% load static %}

{% block content %}
    <div class="container">
        <h1>Running jobs</h1>
        <hr>
        <div id="content" data-url="{% url 'jobs:partial_running_jobs' %}">
        {{content}}
        </div>
    </div>
{% endblock %}


{% block javascript %}
    {{ block.super }}
    <script>
        var need_refresh="{{need_refresh}}";
        if (need_refresh == "True"){
          var intervalID = setInterval(function(){   
            var url = $("#content").attr('data-url')
            $.ajax({
                url: url,
                type: 'get',
                dataType: 'json',
                success: function (data) {
                    $("#content").html(data["content"])
                    if (! data["need_refresh"]){
                        clearInterval(intervalID);
                    }
                }
            });
          },20000);
        }
    </script>
{% endblock %}
